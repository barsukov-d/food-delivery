import{u as P}from"./vue-i18n.runtime.esm-bundler.b3bf75de.js";import{_ as v,Q as $}from"./header.411dd918.js";import{u as y}from"./quasar.esm.prod.6c1988c1.js";import{a1 as _,ax as A,a2 as i,a5 as B,f as n,a4 as V,au as m,a9 as E,av as x,c as F,a7 as o,a3 as C,F as h,a6 as U,b2 as L,aY as S,aX as Q,b4 as f,$ as N,b5 as R,r as j,d as I,aa as w}from"./index.46815d5f.js";import{u as g}from"./cart.2207fa15.js";import{u as O}from"./useProducts.3ce1f0c0.js";import{Q as q}from"./QForm.a9ae8e08.js";import{u as H}from"./useUsers.6b97cfc5.js";import"./axios.060bcb32.js";import"./wait.3fb3bf62.js";import"./QAvatar.7c05a6d7.js";import"./status-codes.44acab52.js";const G={class:"p-5 pb-3 mt-2 h-auto grid rounded-4xl shadow-xl border-secondary border grid-cols-[25%_25%_25%_25%] grid-rows-[auto]"},T={class:"pl-3 block font-bold leading-4"},W=["src"],X={class:"py-2 pl-3 col-start-3 col-end-5 row-start-2 row-end-3 text-sm"},Y={class:"block"},z={class:"block"},J={class:"my-3 w-28 col-start-1 col-end-3 row-start-3 row-end-4 self-center justify-self-center flex items-center justify-between"},K={class:"pl-3 col-start-3 col-end-5 row-start-3 row-end-4 self-center"},M=_({__name:"product-card",props:{product:null},emits:["removeProduct","addProduct","decProduct"],setup(r,{emit:s}){return(d,e)=>{const a=A("RouterLink");return i(),B("div",G,[n(a,{class:"col-start-1 col-end-5 row-start-1 row-end-2 text-xl flex items-center",to:{name:"product",params:{id:r.product.id}}},{default:V(()=>[m("span",T,E(r.product.name),1)]),_:1},8,["to"]),n(x,{class:"w-10 h-10 col-start-3 col-end-5 row-start-1 row-end-2 justify-self-end rounded-full",round:"",color:"primary",icon:"delete",onClick:e[0]||(e[0]=t=>s("removeProduct",r.product.id))}),m("img",{class:"h-40 w-full col-start-1 col-end-3 row-start-2 row-end-3 object-cover rounded-4xl",src:r.product.image},null,8,W),m("div",X,[m("span",Y,E(r.product.description),1),m("span",z,E(r.product.weight)+" \u0433",1)]),m("div",J,[n(x,{class:"w-10 h-10 text-xs",onClick:e[1]||(e[1]=t=>s("addProduct",r.product.id)),round:"",color:"primary",icon:"add",disable:r.product.count>=99},null,8,["disable"]),m("span",null,E(r.product.count),1),n(x,{class:"w-10 h-10 text-xs",onClick:e[2]||(e[2]=t=>s("decProduct",r.product.id)),round:"",color:"primary",icon:"remove",disable:r.product.count<=0},null,8,["disable"])]),m("span",K,"\u0426\u0435\u043D\u0430: "+E(r.product.count*r.product.price),1)])}}}),k=()=>{const{products:r,fetchProducts:s}=O(),d=g(),e=F(()=>d.productsCart.reduce((c,l,p)=>(c[p]=l.id,c),[])),a=F(()=>r.value.reduce((c,l)=>{const p=d.productsCart.find(b=>b.id===l.id);return p&&c.push({...l,count:p.count}),c},[])),t=F(()=>a.value.reduce((c,l)=>l.count?c+l.price*l.count:c,0)),u=F(()=>a.value.reduce((c,l)=>l.count?c+l.count:c,0));return{productsList:a,totalPrice:t,totalProducts:u,fetchProductsList:async()=>await s({id:e.value})}};const Z={key:1,class:"text-2xl text-center"},uu=_({__name:"products-list",setup(r){const s=g(),d=y(),{productsList:e,fetchProductsList:a}=k(),t=l=>{c(l)},u=l=>{s.addProduct(l)},D=l=>{s.decProduct(l)},c=l=>{d.dialog({title:"\u0412\u043D\u0438\u043C\u0430\u043D\u0438\u0435",message:"\u0412\u044B \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u0440\u043E\u0434\u0443\u043A\u0442 ?",persistent:!0,ok:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C",cancel:"\u041E\u0442\u043C\u0435\u043D\u0430"}).onOk(()=>{s.removeProduct(l)}).onCancel(()=>{}).onDismiss(()=>{})};return a(),(l,p)=>o(e).length?(i(),C(L,{key:0,tag:"ul",name:"fade"},{default:V(()=>[(i(!0),B(h,null,U(o(e),b=>(i(),C(M,{key:b.id,product:b,onRemoveProduct:t,onAddProduct:u,onDecProduct:D},null,8,["product"]))),128))]),_:1})):(i(),B("h3",Z,"\u041A\u043E\u0440\u0437\u0438\u043D\u0430 \u043F\u0443\u0441\u0442\u0430"))}}),eu=(r,s)=>(s=s||["\u0442\u043E\u0432\u0430\u0440","\u0442\u043E\u0432\u0430\u0440\u0430","\u0442\u043E\u0432\u0430\u0440\u043E\u0432"])&&s[r%100>4&&r%100<20?2:[2,0,1,1,1,2][r%10<5?r%10:5]],tu={class:"text-2xl"},ou={class:"text-2xl"},ru=_({__name:"total-price",async setup(r){let s,d;const{totalPrice:e,totalProducts:a,fetchProductsList:t}=k();return[s,d]=S(()=>t()),await s,d(),(u,D)=>(i(),C(Q,{class:"p-4 mt-4"},{default:V(()=>[m("h3",tu,"\u0412 \u0437\u0430\u043A\u0430\u0437\u0435: "+E(o(a))+" "+E(o(eu)(o(a),["\u0442\u043E\u0432\u0430\u0440","\u0442\u043E\u0432\u0430\u0440\u0430","\u0442\u043E\u0432\u0430\u0440\u043E\u0432"])),1),m("h2",ou,"\u0417\u0430\u043A\u0430\u0437 \u043D\u0430 \u0441\u0443\u043C\u043C\u0443: "+E(o(e))+" \u0440\u0443\u0431\u043B\u0435\u0439",1)]),_:1}))}}),su=_({__name:"order",props:{modelValue:null},emits:["update:modelValue","submitForm"],setup(r,{emit:s}){const d=r,e=F({get:()=>d.modelValue,set:a=>s("update:modelValue",a)});return(a,t)=>(i(),C(q,{onSubmit:t[8]||(t[8]=u=>s("submitForm"))},{default:V(()=>[n(f,{modelValue:o(e).phoneNumber,"onUpdate:modelValue":t[0]||(t[0]=u=>o(e).phoneNumber=u),label:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",outlined:"",mask:"+#-###-###-##-##",rules:[u=>!!u||"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"]},null,8,["modelValue","rules"]),n(f,{modelValue:o(e).locality,"onUpdate:modelValue":t[1]||(t[1]=u=>o(e).locality=u),label:"\u041D\u0430\u0441\u0435\u043B\u0451\u043D\u043D\u044B\u0439 \u043F\u0443\u043D\u043A\u0442",outlined:"",rules:[u=>!!u||"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"]},null,8,["modelValue","rules"]),n(f,{modelValue:o(e).street,"onUpdate:modelValue":t[2]||(t[2]=u=>o(e).street=u),label:"\u0423\u043B\u0438\u0446\u0430",outlined:"",rules:[u=>!!u||"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"]},null,8,["modelValue","rules"]),n(f,{modelValue:o(e).building,"onUpdate:modelValue":t[3]||(t[3]=u=>o(e).building=u),label:"\u0414\u043E\u043C / \u0441\u0442\u0440\u043E\u0435\u043D\u0438\u0435",outlined:"",rules:[u=>!!u||"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"]},null,8,["modelValue","rules"]),n(f,{class:"mb-5",modelValue:o(e).floor,"onUpdate:modelValue":t[4]||(t[4]=u=>o(e).floor=u),label:"\u042D\u0442\u0430\u0436",outlined:""},null,8,["modelValue"]),n(f,{class:"mb-5",modelValue:o(e).apartment,"onUpdate:modelValue":t[5]||(t[5]=u=>o(e).apartment=u),label:"\u041A\u0432\u0430\u0440\u0442\u0438\u0440\u0430 / \u043E\u0444\u0444\u0438\u0441",outlined:""},null,8,["modelValue"]),n(f,{class:"mb-5",modelValue:o(e).intercomCode,"onUpdate:modelValue":t[6]||(t[6]=u=>o(e).intercomCode=u),label:"\u041A\u043E\u0434 \u0434\u043E\u043C\u043E\u0444\u043E\u043D\u0430",outlined:""},null,8,["modelValue"]),n(f,{class:"mb-5",modelValue:o(e).comment,"onUpdate:modelValue":t[7]||(t[7]=u=>o(e).comment=u),label:"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439",outlined:""},null,8,["modelValue"]),n(x,{class:"ui-button mx-0 mt-5 w-full",type:"submit",color:"primary",label:"\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437"})]),_:1}))}}),lu=_({__name:"order",setup(r){const s=y(),{t:d}=P();N();const e=g(),a=R(),{fetchUserOrder:t}=H(),u=j({phoneNumber:"",locality:"",street:"",building:"",floor:"",apartment:"",intercomCode:"",comment:""}),D=()=>{c()},c=()=>{s.dialog({title:"\u0423\u0441\u043F\u0435\u0445",message:"\u0412\u0430\u0448 \u0437\u0430\u043A\u0430\u0437 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D",ok:"\u042F\u0441\u043D\u043E"}).onOk(()=>{t(u.value,a?.user?.id?.toString()),e.clearCart()}).onCancel(()=>{}).onDismiss(()=>{})};return(l,p)=>(i(),B(h,null,[n(v,{header:o(d)("order.formHeader")},null,8,["header"]),n(su,{onSubmitForm:D,modelValue:o(u),"onUpdate:modelValue":p[0]||(p[0]=b=>I(u)?u.value=b:null)},null,8,["modelValue"])],64))}}),Du=_({__name:"cart",setup(r){const{t:s}=P(),d=g();return(e,a)=>(i(),C($,null,{default:V(()=>[n(v,{header:o(s)("order.pageHeader")},null,8,["header"]),n(uu),o(d).productsCart.length>0?(i(),C(ru,{key:0})):w("",!0),o(d).productsCart.length>0?(i(),C(lu,{key:1})):w("",!0)]),_:1}))}});export{Du as default};
