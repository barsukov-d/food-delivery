import{u as v}from"./vue-i18n.runtime.esm-bundler.53e1aa22.js";import{_ as y,Q as $}from"./header.49e47568.js";import{u as h}from"./quasar.esm.prod.13eb2a52.js";import{a0 as b,aw as A,a1 as m,a5 as B,f as a,a3 as V,au as w,at as p,a8 as _,c as F,a4 as r,a2 as E,b1 as U,a6 as L,F as k,aX as S,aW as Q,b3 as f,_ as N,b4 as R,r as j,d as I,a9 as P}from"./index.eae3a570.js";import{u as g}from"./cart.cac68b30.js";import{u as O}from"./useProducts.705a8918.js";import{Q as q}from"./QForm.22a65369.js";import{u as H}from"./useUsers.e62a0d96.js";import"./axios.dac49c53.js";import"./wait.354c5c21.js";import"./QAvatar.b3f4fc0b.js";const W={class:"p-5 pb-3 mt-2 h-auto grid rounded-4xl shadow-xl border-secondary border grid-cols-[25%_25%_25%_25%] grid-rows-[auto]"},G={class:"pl-3 block font-bold leading-4"},T=["src"],X={class:"py-2 pl-3 col-start-3 col-end-5 row-start-2 row-end-3 text-sm"},z={class:"block"},J={class:"block"},K={class:"my-3 w-28 col-start-1 col-end-3 row-start-3 row-end-4 self-center justify-self-center flex items-center justify-between"},M={class:"pl-3 col-start-3 col-end-5 row-start-3 row-end-4 self-center"},Y=b({__name:"product-card",props:{product:{}},emits:["removeProduct","addProduct","decProduct"],setup(c,{emit:l}){return(o,e)=>{const n=A("RouterLink");return m(),B("div",W,[a(n,{class:"col-start-1 col-end-5 row-start-1 row-end-2 text-xl flex items-center",to:{name:"product",params:{id:o.product.id}}},{default:V(()=>[p("span",G,_(o.product.name),1)]),_:1},8,["to"]),a(w,{class:"w-10 h-10 col-start-3 col-end-5 row-start-1 row-end-2 justify-self-end rounded-full",round:"",color:"primary",icon:"delete",onClick:e[0]||(e[0]=t=>l("removeProduct",o.product.id))}),p("img",{class:"h-40 w-full col-start-1 col-end-3 row-start-2 row-end-3 object-cover rounded-4xl",src:o.product.image},null,8,T),p("div",X,[p("span",z,_(o.product.description),1),p("span",J,_(o.product.weight)+" \u0433",1)]),p("div",K,[a(w,{class:"w-10 h-10 text-xs",onClick:e[1]||(e[1]=t=>l("addProduct",o.product.id)),round:"",color:"primary",icon:"add",disable:o.product.count>=99},null,8,["disable"]),p("span",null,_(o.product.count),1),a(w,{class:"w-10 h-10 text-xs",onClick:e[2]||(e[2]=t=>l("decProduct",o.product.id)),round:"",color:"primary",icon:"remove",disable:o.product.count<=0},null,8,["disable"])]),p("span",M,"\u0426\u0435\u043D\u0430: "+_(o.product.count*o.product.price),1)])}}}),x=()=>{const{products:c,fetchProducts:l}=O(),o=g(),e=F(()=>o.productsCart.reduce((d,s,i)=>(d[i]=s.id,d),[])),n=F(()=>c.value.reduce((d,s)=>{const i=o.productsCart.find(C=>C.id===s.id);return i&&d.push({...s,count:i.count}),d},[])),t=F(()=>n.value.reduce((d,s)=>s.count?d+s.price*s.count:d,0)),u=F(()=>n.value.reduce((d,s)=>s.count?d+s.count:d,0));return{productsList:n,totalPrice:t,totalProducts:u,fetchProductsList:async()=>await l({id:e.value})}};const Z={key:1,class:"text-2xl text-center"},uu=b({__name:"products-list",setup(c){const l=g(),o=h(),{productsList:e,fetchProductsList:n}=x(),t=s=>{d(s)},u=s=>{l.addProduct(s)},D=s=>{l.decProduct(s)},d=s=>{o.dialog({title:"\u0412\u043D\u0438\u043C\u0430\u043D\u0438\u0435",message:"\u0412\u044B \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u0440\u043E\u0434\u0443\u043A\u0442 ?",persistent:!0,ok:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C",cancel:"\u041E\u0442\u043C\u0435\u043D\u0430"}).onOk(()=>{l.removeProduct(s)}).onCancel(()=>{}).onDismiss(()=>{})};return n(),(s,i)=>r(e).length?(m(),E(U,{key:0,tag:"ul",name:"fade"},{default:V(()=>[(m(!0),B(k,null,L(r(e),C=>(m(),E(Y,{key:C.id,product:C,onRemoveProduct:t,onAddProduct:u,onDecProduct:D},null,8,["product"]))),128))]),_:1})):(m(),B("h3",Z,"\u041A\u043E\u0440\u0437\u0438\u043D\u0430 \u043F\u0443\u0441\u0442\u0430"))}}),eu=(c,l)=>(l=l||["\u0442\u043E\u0432\u0430\u0440","\u0442\u043E\u0432\u0430\u0440\u0430","\u0442\u043E\u0432\u0430\u0440\u043E\u0432"])&&l[c%100>4&&c%100<20?2:[2,0,1,1,1,2][c%10<5?c%10:5]],tu={class:"text-2xl"},ou={class:"text-2xl"},ru=b({__name:"total-price",async setup(c){let l,o;const{totalPrice:e,totalProducts:n,fetchProductsList:t}=x();return[l,o]=S(()=>t()),await l,o(),(u,D)=>(m(),E(Q,{class:"p-4 mt-4"},{default:V(()=>[p("h3",tu,"\u0412 \u0437\u0430\u043A\u0430\u0437\u0435: "+_(r(n))+" "+_(r(eu)(r(n),["\u0442\u043E\u0432\u0430\u0440","\u0442\u043E\u0432\u0430\u0440\u0430","\u0442\u043E\u0432\u0430\u0440\u043E\u0432"])),1),p("h2",ou,"\u0417\u0430\u043A\u0430\u0437 \u043D\u0430 \u0441\u0443\u043C\u043C\u0443: "+_(r(e))+" \u0440\u0443\u0431\u043B\u0435\u0439",1)]),_:1}))}}),su=b({__name:"order",props:{modelValue:{}},emits:["update:modelValue","submitForm"],setup(c,{emit:l}){const o=c,e=F({get:()=>o.modelValue,set:n=>l("update:modelValue",n)});return(n,t)=>(m(),E(q,{onSubmit:t[8]||(t[8]=u=>l("submitForm"))},{default:V(()=>[a(f,{modelValue:r(e).phoneNumber,"onUpdate:modelValue":t[0]||(t[0]=u=>r(e).phoneNumber=u),label:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",outlined:"",mask:"+#-###-###-##-##",rules:[u=>!!u||"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"]},null,8,["modelValue","rules"]),a(f,{modelValue:r(e).locality,"onUpdate:modelValue":t[1]||(t[1]=u=>r(e).locality=u),label:"\u041D\u0430\u0441\u0435\u043B\u0451\u043D\u043D\u044B\u0439 \u043F\u0443\u043D\u043A\u0442",outlined:"",rules:[u=>!!u||"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"]},null,8,["modelValue","rules"]),a(f,{modelValue:r(e).street,"onUpdate:modelValue":t[2]||(t[2]=u=>r(e).street=u),label:"\u0423\u043B\u0438\u0446\u0430",outlined:"",rules:[u=>!!u||"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"]},null,8,["modelValue","rules"]),a(f,{modelValue:r(e).building,"onUpdate:modelValue":t[3]||(t[3]=u=>r(e).building=u),label:"\u0414\u043E\u043C / \u0441\u0442\u0440\u043E\u0435\u043D\u0438\u0435",outlined:"",rules:[u=>!!u||"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"]},null,8,["modelValue","rules"]),a(f,{class:"mb-5",modelValue:r(e).floor,"onUpdate:modelValue":t[4]||(t[4]=u=>r(e).floor=u),label:"\u042D\u0442\u0430\u0436",outlined:""},null,8,["modelValue"]),a(f,{class:"mb-5",modelValue:r(e).apartment,"onUpdate:modelValue":t[5]||(t[5]=u=>r(e).apartment=u),label:"\u041A\u0432\u0430\u0440\u0442\u0438\u0440\u0430 / \u043E\u0444\u0444\u0438\u0441",outlined:""},null,8,["modelValue"]),a(f,{class:"mb-5",modelValue:r(e).intercomCode,"onUpdate:modelValue":t[6]||(t[6]=u=>r(e).intercomCode=u),label:"\u041A\u043E\u0434 \u0434\u043E\u043C\u043E\u0444\u043E\u043D\u0430",outlined:""},null,8,["modelValue"]),a(f,{class:"mb-5",modelValue:r(e).comment,"onUpdate:modelValue":t[7]||(t[7]=u=>r(e).comment=u),label:"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439",outlined:""},null,8,["modelValue"]),a(w,{class:"ui-button mx-0 mt-5 w-full",type:"submit",color:"primary",label:"\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437"})]),_:1}))}}),lu=b({__name:"order",setup(c){const l=h(),{t:o}=v();N();const e=g(),n=R(),{fetchUserOrder:t}=H(),u=j({phoneNumber:"",locality:"",street:"",building:"",floor:"",apartment:"",intercomCode:"",comment:""}),D=()=>{d()},d=()=>{l.dialog({title:"\u0423\u0441\u043F\u0435\u0445",message:"\u0412\u0430\u0448 \u0437\u0430\u043A\u0430\u0437 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D",ok:"\u042F\u0441\u043D\u043E"}).onOk(()=>{var s,i;t(u.value,(i=(s=n==null?void 0:n.user)==null?void 0:s.id)==null?void 0:i.toString()),e.clearCart()}).onCancel(()=>{}).onDismiss(()=>{})};return(s,i)=>(m(),B(k,null,[a(y,{header:r(o)("order.formHeader")},null,8,["header"]),a(su,{onSubmitForm:D,modelValue:r(u),"onUpdate:modelValue":i[0]||(i[0]=C=>I(u)?u.value=C:null)},null,8,["modelValue"])],64))}}),bu=b({__name:"cart",setup(c){const{t:l}=v(),o=g();return(e,n)=>(m(),E($,null,{default:V(()=>[a(y,{header:r(l)("order.pageHeader")},null,8,["header"]),a(uu),r(o).productsCart.length>0?(m(),E(ru,{key:0})):P("",!0),r(o).productsCart.length>0?(m(),E(lu,{key:1})):P("",!0)]),_:1}))}});export{bu as default};
